<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="utf-8">
<title>NUCLEAR BHAI v3</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<style>
  body{margin:0;background:#000;color:#fff;font-family:Arial;display:flex;align-items:center;justify-content:center;height:100vh}
  #lock,#app{display:none;background:#111;padding:40px;border-radius:20px;text-align:center;width:90%;max-width:420px;box-shadow:0 0 50px #f00}
  #app{display:none;width:95%;max-width:950px;height:92vh}
  h1{font-size:3em;background:linear-gradient(90deg,#ff6b6b,#feca57,#48dbfb);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
  input{width:100%;padding:16px;margin:12px 0;border-radius:50px;background:#333;border:none;color:#fff;text-align:center;font-size:1.1em}
  button{width:100%;padding:16px;background:#ff4757;border:none;border-radius:50px;color:#fff;font-size:1.3em;cursor:pointer}
  
  #chat{
    height:75vh;
    overflow-y:auto;
    background:#000;
    padding:20px;
    border-radius:15px;
    /* UX Improvement: Prevents scroll jumping */
    overflow-anchor: auto; 
  }
  .msg{max-width:80%;padding:14px 20px;border-radius:20px;margin:10px 0;clear:both}
  .user{background:#ff4757;float:right}
  .ai{background:#333;float:left}
  
  /* UX Improvement: Style for loading dots */
  .ai.loading::after {
    content: '...';
    animation: pulse 1.5s infinite;
  }
  @keyframes pulse {
    0% { opacity: .2; }
    50% { opacity: 1; }
    100% { opacity: .2; }
  }

  #input-area{display:flex;gap:10px;margin-top:10px}
  #msg{flex:1;padding:16px;border-radius:50px;background:#333;border:none;color:#fff;font-size:1.1em}
  #send{padding:16px 35px;background:#ff4757;border:none;border-radius:50px;color:#fff;font-weight:bold}
</style>
</head>
<body>

<div id="lock" style="display:block">
  <h1>NUCLEAR BHAI v3</h1>
  <p>OpenAI Key (sk-proj-...) is required</p>
  <input type="password" id="k" placeholder="sk-proj-...">
  <button onclick="unlock()">UNLOCK</button>
</div>

<div id="app">
  <h1>NUCLEAR BHAI v3</h1>
  <div id="chat">
    <div class="msg ai">भाई आ गया! अब जो बोलेगा – सीधे GPT-4o को जाएगा।<br>Instagram, Netflix, Game, App – जो मर्ज़ी बोल!</div>
  </div>
  <div id="input-area">
    <input type="text" id="msg" placeholder="Bolo bhai..." autocomplete="off">
    <button id="send" onclick="send()">SEND</button>
  </div>
</div>

<script>
// Removed const PASS = "sabru420"; for security
let KEY = "";

function unlock(){
  let keyVal = document.getElementById("k").value.trim();
  // Improved validation: Check for sk-proj- and minimum realistic length
  if(keyVal.startsWith("sk-proj-") && keyVal.length > 40){ 
    KEY = keyVal;
    document.getElementById("lock").style.display="none";
    document.getElementById("app").style.display="block";
    document.getElementById("msg").focus();
  }else alert("Invalid OpenAI Key! Key must start with sk-proj- and be valid.");
}

document.getElementById("msg").addEventListener("keypress",e=>{if(e.key==="Enter")send()});

async function send(){
  let m = document.getElementById("msg").value.trim();
  if(!m) return;
  add(m,"user"); document.getElementById("msg").value="";
  
  // UX Improvement: Use 'loading' class for animation
  let t = document.createElement("div"); 
  t.className="msg ai loading"; 
  t.textContent="GPT-4o bana raha hai"; 
  document.getElementById("chat").appendChild(t);
  
  try{
    let r = await fetch("https://api.openai.com/v1/chat/completions",{
      method:"POST",
      headers:{"Authorization":"Bearer "+KEY,"Content-Type":"application/json"},
      body:JSON.stringify({model:"gpt-4o",messages:[{role:"user",content:m}],temperature:0.8,max_tokens:4000})
    });
    let d = await r.json();
    document.getElementById("chat").removeChild(t);
    
    // Added a check for API errors (d.error)
    if(d.error){
        add("Error from OpenAI: "+d.error.message,"ai");
    } else {
        add(d.choices[0].message.content,"ai");
    }
  }catch(e){
    document.getElementById("chat").removeChild(t);
    add("Network/Fetch Error: "+e.message,"ai");
  }
}

function add(txt,type){
  let d = document.createElement("div");
  d.className = "msg "+type;
  d.innerHTML = txt.replace(/\n/g,"<br>");
  document.getElementById("chat").appendChild(d);
  document.getElementById("chat").scrollTop = document.getElementById("chat").scrollHeight;
}
</script>
</body>
</html>
